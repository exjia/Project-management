(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3748"],{"15c5":function(e,a,t){},3905:function(e,a,t){"use strict";var r=t("15c5"),s=t.n(r);s.a},ae1d:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("Form",{ref:"addPersonData",attrs:{rules:e.ruleValidate,model:e.addPersonData,"label-width":120}},[t("Card",[t("p",{attrs:{slot:"title"},slot:"title"},[t("Icon",{attrs:{type:"edit"}}),e._v("\n                添加日报\n            ")],1),t("Row",[t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"工作日期："}},[t("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择工作日期",clearable:""},model:{value:e.addPersonData.recordTime,callback:function(a){e.$set(e.addPersonData,"recordTime",a)},expression:"addPersonData.recordTime"}})],1)],1)],1),t("Row",[t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"员工编号："}},[t("Input",{staticStyle:{width:"100%"},attrs:{disabled:""},model:{value:e.addPersonData.userCode,callback:function(a){e.$set(e.addPersonData,"userCode",a)},expression:"addPersonData.userCode"}})],1)],1),t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"员工姓名："}},[t("Input",{staticStyle:{width:"100%"},attrs:{disabled:""},model:{value:e.addPersonData.userName,callback:function(a){e.$set(e.addPersonData,"userName",a)},expression:"addPersonData.userName"}})],1)],1)],1),t("Row",[t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"任务代码：",prop:"projectTaskCode"}},[t("Select",{staticStyle:{width:"100%"},attrs:{"label-in-value":!0,filterable:"",remote:"","remote-method":e.searchprojectCode,loading:e.loading,placeholder:"请输入任务名称|自动搜索"},on:{"on-change":e.getProjectOwnCode},model:{value:e.addPersonData.projectTaskCode,callback:function(a){e.$set(e.addPersonData,"projectTaskCode",a)},expression:"addPersonData.projectTaskCode"}},e._l(e.searchprojectCodeData,function(a){return t("Option",{key:a.code,attrs:{value:a.code+"$^"+a.value}},[e._v(e._s(a.code))])}))],1)],1),t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"任务名称："}},[t("Input",{staticStyle:{width:"100%"},attrs:{disabled:""},model:{value:e.addPersonData.projectTaskName,callback:function(a){e.$set(e.addPersonData,"projectTaskName",a)},expression:"addPersonData.projectTaskName"}})],1)],1)],1),t("Row",[t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"模块名称：",prop:"modularName"}},[t("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请按照计划中模块填写"},model:{value:e.addPersonData.modularName,callback:function(a){e.$set(e.addPersonData,"modularName",a)},expression:"addPersonData.modularName"}})],1)],1),t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"系统名称：",prop:"systemName"}},[t("Select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","remote-method":e.searchSystem,loading:e.loading,placeholder:"请输入系统名称|自动搜索"},model:{value:e.addPersonData.systemName,callback:function(a){e.$set(e.addPersonData,"systemName",a)},expression:"addPersonData.systemName"}},e._l(e.searchSystemData,function(a){return t("Option",{key:a.value,attrs:{value:a.value,label:a.value}},[e._v(e._s(a.value))])}))],1)],1)],1),t("Row",[t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"任务大类：",prop:"superiorTask"}},[t("Select",{attrs:{"label-in-value":!0,filterable:"",loading:e.loading,placeholder:"全部"},on:{"on-change":e.searchLowerTask}},e._l(e.searchSuperiorTaskData,function(a){return t("Option",{key:a.value,attrs:{value:a.code,label:a.value}},[e._v(e._s(a.value))])}))],1)],1),t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"任务小类：",prop:"lowerTask"}},[t("Select",{attrs:{filterable:"",loading:e.loading,placeholder:"全部"},model:{value:e.addPersonData.lowerTask,callback:function(a){e.$set(e.addPersonData,"lowerTask",a)},expression:"addPersonData.lowerTask"}},e._l(e.searchLowerTaskData,function(a){return t("Option",{key:a.value,attrs:{value:a.value,label:a.value}},[e._v(e._s(a.value))])}))],1)],1)],1),t("Row",[t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"开始时间：",prop:"startTime"}},[t("TimePicker",{staticStyle:{width:"100%"},attrs:{format:"HH:mm:ss",placeholder:"请选择开始时间"},on:{"on-change":e.getTaskUseTime},model:{value:e.addPersonData.startTime,callback:function(a){e.$set(e.addPersonData,"startTime",a)},expression:"addPersonData.startTime"}})],1)],1),t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"结束时间：",prop:"endTime"}},[t("TimePicker",{staticStyle:{width:"100%"},attrs:{format:"HH:mm:ss",placeholder:"请选择结束时间"},on:{"on-change":e.getTaskUseTime},model:{value:e.addPersonData.endTime,callback:function(a){e.$set(e.addPersonData,"endTime",a)},expression:"addPersonData.endTime"}})],1)],1)],1),t("Row",[t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"任务用时："}},[t("Input",{staticStyle:{width:"100%"},attrs:{disabled:""},model:{value:e.addPersonData.taskUseTime,callback:function(a){e.$set(e.addPersonData,"taskUseTime",a)},expression:"addPersonData.taskUseTime"}})],1)],1),t("Col",{attrs:{span:"8",offset:"2"}},[t("FormItem",{attrs:{label:"完成百分比：",prop:"taskCompletePercent"}},[t("Input",{staticStyle:{width:"100%"},model:{value:e.addPersonData.taskCompletePercent,callback:function(a){e.$set(e.addPersonData,"taskCompletePercent",a)},expression:"addPersonData.taskCompletePercent"}}),t("span",{staticClass:"percent-icon"},[e._v("%")])],1)],1)],1),t("Row",[t("Col",{attrs:{span:"18",offset:"2"}},[t("FormItem",{attrs:{label:"工作备注：",prop:"workInfoRemake"}},[t("Input",{staticStyle:{width:"100%"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:2}},model:{value:e.addPersonData.workInfoRemake,callback:function(a){e.$set(e.addPersonData,"workInfoRemake",a)},expression:"addPersonData.workInfoRemake"}})],1)],1)],1),t("Row",[t("Col",{attrs:{span:"4",offset:"9"}},[t("Button",{attrs:{type:"primary",icon:"ios-checkmark-circle-outline"},on:{click:function(a){e.addPersonToRev("addPersonData")}}},[e._v("保存")])],1)],1),t("Row",[t("Table",{staticClass:"margin-top-20 margin-bottom-10",attrs:{data:e.tableData,columns:e.tableColumns}})],1),t("Row",[t("Col",{attrs:{span:"4",offset:"9"}},[t("Button",{attrs:{type:"primary",icon:"ios-checkmark-circle-outline"},on:{click:function(a){e.submitAddData()}}},[e._v("提交")])],1),t("Col",{attrs:{span:"4"}},[t("Button",{attrs:{type:"primary",icon:"ios-undo"},on:{click:function(a){return a.preventDefault(),e.pageBack(a)}}},[e._v("返回")])],1)],1)],1)],1)],1)},s=[],o=(t("7f7f"),t("c93e")),n=(t("28a5"),t("cadf"),t("551c"),t("097d"),t("c276")),d=t("2f62"),i=t("a78e"),l=t.n(i),c={name:"personAdd",data:function(){var e=this,a=function(e,a,t){a.length>200&&t(new Error("备注最大长度200!")),t()},t=function(a,t,r){var s=/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/;Object(n["l"])(e.addPersonData.taskCompletePercent)?r(new Error("值不能为空")):s.test(e.addPersonData.taskCompletePercent)?e.addPersonData.taskCompletePercent>100&&r(new Error("应小于等于100%")):r(new Error("应为正数,最多保留两位小数")),r()},r=function(a,t,r){var s=t.split(":"),o=e.addPersonData.endTime.split(":"),n=3600*s[0]+60*s[1]+s[2],d=3600*o[0]+60*o[1]+o[2];" "===t||null===t?r(new Error("请选择开始时间!")):(n>d||n===d)&&r(new Error("开始时间要小于结束时间")),r()},s=function(a,t,r){var s=e.addPersonData.startTime.split(":"),o=t.split(":"),n=3600*s[0]+60*s[1]+s[2],d=3600*o[0]+60*o[1]+o[2];" "===t||null===t?r(new Error("请选择结束时间!")):(n>d||n===d)&&r(new Error("结束时间要大于开始时间")),r()},o=function(e,a,t){" "!==a&&null!==a||t(new Error("请选择任务大类!")),t()};return{tableData:[],i:0,ruleValidate:{projectTaskCode:[{required:!0,message:"请输入任务代码!"}],modularName:[{required:!0,message:"请输入模块名称!",trigger:"change"}],systemName:[{required:!0,message:"请输入系统名称!",trigger:"change"}],superiorTask:[{required:!0,message:"请选择任务大类!",trigger:"change"},{validator:o}],lowerTask:[{required:!0,message:"请选择任务小类!",trigger:"change"}],startTime:[{required:!0,message:"请选择开始时间!",trigger:"change"},{validator:r}],endTime:[{required:!0,message:"请选择开始时间!",trigger:"change"},{validator:s}],taskCompletePercent:[{required:!0,message:"请填写百分比!",trigger:"change"},{validator:t}],workInfoRemake:[{required:!0,message:"请填写备注!",trigger:"change"},{validator:a}]},tableColumns:[{title:"员工编号",align:"center",key:"userCode",width:100},{title:"员工姓名",align:"center",key:"userName",width:100},{title:"工作日期",align:"center",key:"recordTime",width:110},{title:"任务代码",align:"center",key:"projectTaskCode",width:180},{title:"任务名称",align:"center",key:"projectTaskName",width:180},{title:"模块名称",align:"center",key:"modularName",width:100},{title:"系统名称",align:"center",key:"systemName",width:100},{title:"任务大类",align:"center",key:"superiorTask",width:100},{title:"任务小类",align:"center",key:"lowerTask",width:150},{title:"开始时间",align:"center",key:"startTime",width:100},{title:"结束时间",align:"center",key:"endTime",width:100},{title:"完成百分比",align:"center",key:"taskCompletePercent",width:120},{title:"任务用时",align:"center",key:"taskUseTime",width:100},{title:"查看",align:"center",width:80,fixed:"right",render:function(a,t){return a("div",[a("Button",{props:{type:"error",size:"small"},style:{marginRight:"0px"},on:{click:function(){e.remove(t.index)}}},"删除")])}}]}},computed:Object(o["a"])({},Object(d["e"])({addPersonData:function(e){var a=e.personAdd;return a.addPersonData},searchprojectCodeData:function(e){var a=e.personAdd;return a.searchprojectCodeData},searchSystemData:function(e){var a=e.personAdd;return a.searchSystemData},searchSuperiorTaskData:function(e){var a=e.personAdd;return a.searchSuperiorTaskData},searchLowerTaskData:function(e){var a=e.personAdd;return a.searchLowerTaskData},getTaskUseTimedata:function(e){var a=e.personAdd;return a.getTaskUseTimedata},loading:function(e){var a=e.personAdd;return a.loading},message:function(e){var a=e.personAdd;return a.message}})),methods:Object(o["a"])({},Object(d["b"])(["handleQueryBySearchprojectCode","handleQueryBySearchSystem","handleAddPersonToRev","handleResetSearchPersonData","handleQueryBysearchSuperiorTask","handleQueryBygetTaskUseTime","handleQueryBysearchLowerTask"]),{init:function(){this.addPersonData.userName=l.a.get("userName"),this.addPersonData.userCode=l.a.get("userCode"),this.addPersonData.recordTime=new Date,this.addPersonData.startTime=new Date((new Date).getTime()-36e5),this.addPersonData.endTime=new Date,this.addPersonData.taskUseTime=1,this.searchSuperiorTask(),this.searchSuperiorTask(),Object(n["o"])()},pageBack:function(){var e=this;this.handleResetSearchPersonData().then(function(a){e.$router.push({name:"personmainList"})})},searchSystem:function(e){this.handleQueryBySearchSystem(e).then(function(e){})},searchprojectCode:function(e){this.handleQueryBySearchprojectCode(e).then(function(e){})},getProjectOwnCode:function(e){console.log(e),this.addPersonData.projectTaskName=this.addPersonData.projectTaskCode.split("$^")[1]},getTaskUseTime:function(e){var a=this;if(""!==this.addPersonData.startTime&&""!==this.addPersonData.endTime){var t={startTime:this.addPersonData.startTime,endTime:this.addPersonData.endTime};this.handleQueryBygetTaskUseTime(t).then(function(e){a.addPersonData.taskUseTime=a.getTaskUseTimedata})}},searchSuperiorTask:function(e){this.handleQueryBysearchSuperiorTask(e).then(function(e){})},searchLowerTask:function(e){this.addPersonData.superiorTask=e.label,this.addPersonData.lowerTask="",this.handleQueryBysearchLowerTask(e.value).then(function(e){})},remove:function(e){this.tableData.splice(e,1)},save:function(){var e={};e.userCode=this.addPersonData.userCode,e.userName=this.addPersonData.userName,e.recordTime=Object(n["c"])(this.addPersonData.recordTime,"yyyy-MM-dd"),e.projectTaskCode=this.addPersonData.projectTaskCode.split("$^")[0],e.projectTaskName=this.addPersonData.projectTaskName,e.modularName=this.addPersonData.modularName,e.systemName=this.addPersonData.systemName,e.superiorTask=this.addPersonData.superiorTask,e.lowerTask=this.addPersonData.lowerTask,e.startTime=this.addPersonData.startTime,e.endTime=this.addPersonData.endTime,e.taskCompletePercent=this.addPersonData.taskCompletePercent,e.taskUseTime=this.addPersonData.taskUseTime,this.tableData.push(e),console.log(this.tableData)},submitAddData:function(){var e=this;this.handleAddPersonToRev(this.tableData).then(function(a){"日报保存成功"==e.message?e.$Modal.success({title:"提示",content:e.message,onOk:function(){e.$router.push({name:"personmainList"})}}):e.$Modal.error({title:"提示",content:e.message})})},addPersonToRev:function(e){var a=this;this.$refs[e].validate(function(e){e?a.save():a.$Message.error("验证错误!")})}}),mounted:function(){this.init()}},m=c,u=(t("3905"),t("2877")),p=Object(u["a"])(m,r,s,!1,null,null,null);p.options.__file="personMainTenanceAdd.vue";a["default"]=p.exports}}]);